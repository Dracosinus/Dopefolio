<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Case Study of Project 3</title>
    <meta name="description" content="Case study page of Project" />

    <link rel="stylesheet" href="css/style.css" />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;600;700;900&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <header class="header">
      <div class="header__content">
        <div class="header__logo-container">
          <div class="header__logo-img-cont">
            <img
              src="./assets/png/face_co1.png"
              alt="Benoit SCHULER Logo Image"
              class="header__logo-img"
            />
          </div>
          <span class="header__logo-sub">Benoit SCHULER</span>
        </div>
        <div class="header__main">
          <ul class="header__links">
            <li class="header__link-wrapper">
              <a href="./index.html" class="header__link"> Home </a>
            </li>
            <li class="header__link-wrapper">
              <a href="./index.html#about" class="header__link">About </a>
            </li>
            <li class="header__link-wrapper">
              <a href="./index.html#projects" class="header__link">Projects</a>
            </li>
            <li class="header__link-wrapper">
              <a href="./index.html#contact" class="header__link"> Contact </a>
            </li>
          </ul>
          <div class="header__main-ham-menu-cont">
            <img
              src="./assets/svg/ham-menu.svg"
              alt="hamburger menu"
              class="header__main-ham-menu"
            />
            <img
              src="./assets/svg/ham-menu-close.svg"
              alt="hamburger menu close"
              class="header__main-ham-menu-close d-none"
            />
          </div>
        </div>
      </div>
      <div class="header__sm-menu">
        <div class="header__sm-menu-content">
          <ul class="header__sm-menu-links">
            <li class="header__sm-menu-link">
              <a href="./index.html"> Home </a>
            </li>

            <li class="header__sm-menu-link">
              <a href="./index.html#about"> About </a>
            </li>

            <li class="header__sm-menu-link">
              <a href="./index.html#projects"> Projects </a>
            </li>

            <li class="header__sm-menu-link">
              <a href="./index.html#contact"> Contact </a>
            </li>
          </ul>
        </div>
      </div>
    </header>
    <section class="project-cs-hero">
      <div class="project-cs-hero__content">
        <h1 class="heading-primary">Asterisk SIPP auto-test</h1>
        <div class="project-cs-hero__info">
          <p class="text-primary">
            Asterisk est un composant fondateur de XiVO, à la base de la mise en place et du traitement des communications établies par le système.
            Son test et leur automatisation est donc un enjeu d'une égale importance.
          </p>
        </div>
      </div>
    </section>
    <section class="project-details">
      <div class="main-container">
        <div class="project-details__content">
          <div class="project-details__content-main">
            <div class="project-details__desc">
              <h3 class="project-details__content-title">Project Overview</h3>
              <p class="project-details__desc-para">
                Asterisk est une plateforme logicielle open-source qui permet de mettre en place un système de téléphonie complet basé sur le protocole SIP (Session Initiation Protocol).
Composant central de XiVO, la bonne utilisation d'Asterisk est vitale pour notre produit. C'est en configurant ses fonctionnalités, ses diverses extensions et ses multiples paramètres que XiVO tire une part substantielle de ses capacités.

              </p>
              <p class="project-details__desc-para">
                Asterisk permet de router les appels et d'adapter leur comportement via des scripts de dialplan. Les appels, initiés via des requêtes SIP émises par les composants téléphoniques, entrent dans le dialplan via des contextes définis. En voici un exemple simple :
              </p>
              <pre style="font-size: 15px;">
                ; extensions.conf

                [default]
                exten => s,1,Answer()                              ; Répond à l'appel
                   same => n,Playback(welcome-message)             ; Lit un message d'accueil
                   same => n,Hangup()                              ; Raccroche l'appel

                exten => 1,1,Dial(SIP/extension1)                  ; Appel vers une extension SIP
                   same => n,Hangup()

                exten => 2,1,Dial(SIP/extension2)                  ; Appel vers une autre extension SIP
                   same => n,Hangup()

                exten => 9,1,NoOp(echo "Hello, Asterisk!")        ; Affiche un message dans la CLI
                   same => n,Hangup()
              </pre>
              <p class="project-details__desc-para">
                Asterisk peut donc appeller, raccrocher un appel entrant, logger, entre autres. Et XiVO met à disposition une multitude d'option pour configurer ces options et comportements sans avoir à écrire de dialplan directement.              </p>
              <p class="project-details__desc-para">
                Il est important pour nous de pouvoir tester ce dialplan. A notre connaissance, il n'existe pas encore de façon de le tester unitairement, sur les subroutines qui sont là-bas l'équivalent de ce que serait une fonction dans un langage de programmation. Cependant Asterisk a à sa disposition SIPp (SIP Performance Testing Tool), un outil open-source capable de simuler les appels et de tester ses performances et sa scalabilité.
              </p>
              <p class="project-details__desc-para">
                Asterisk permet de router les appels et d'adapter leur comportement via des scripts de dialplan. Les appels, initiés via des requêtes SIP émises par les composants téléphoniques, entrent dans le dialplan via des contextes définis. En voici un exemple simple :
              </p>
              <p class="project-details__desc-para">
                SIPp permet de simuler deux types de scénarios personnalisables sous la forme de fichier xml : User Agent Client (UAC) et User Agent Server (UAS). Dans un scénario UAC, vous pouvez définir des demandes d'INVITE, des réponses attendues et des actions à effectuer lors de la réception de certaines réponses. Ce scénario est donc actif, émet l'appel et attends d'Asterisk des actions spécifiées dans le test. Dans un scénario UAS, vous pouvez définir les actions à effectuer lors de la réception d'une demande d'INVITE, puis envoyer des réponses appropriées. Ce scénario est donc passif, mais comme l'UAC il attends un nombre définis de réponse pour être validés.
              </p>
              <p class="project-details__desc-para">
                Dans le contexte d'un développement spécifique pour l'un de nos clients, j'ai écrit des extensions de scripts de dialplan. Si nous avons couvert les premières fonctionnalités par des tests manuels, certaines implémentations contenaient d'important tableaux de correspondance, où tel cas de figure précis devait déclencher tel message joué à l'appellant/à l'appellé, ce qu'Asterisk est capable de faire. Mais comment automatiser ceci ?
              </p>
              <p class="project-details__desc-para">
                Une approche de test au cour du développement était d'écrire des extensions spécifiques dans le dialplan puis les stimuler au moyen de scénarios UAC pour vérifier les différents cas de figure. Ces scénarios étaient lancés depuis la machine de développement, où SIPp était disponible. La limitation évidente de ce test était qu'on ne vérifiait pas vraiment la section de dialplan intéressantes mais une section mockée de celui-ci.
              </p>
              <p class="project-details__desc-para">
                Pour faire évoluer ce processus, il faudrait pouvoir lancer les scénarios UAS sur le serveur Asterisk contenant le dialplan que nous testons. Nous y sommes parvenus, grâce à une version containerisée de SIPp qui nous permettais de lancer les scénarios sans nous soucier d'installer l'outil de test sur une machine où il n'avait pas de raison d'être installée.
              </p>
              <p class="project-details__desc-para">
                Voici la commande utilisée côté serveur en bouclant sur la variable ${suffix} :
              </p>
              <pre style="font-size: 15px;">
                docker run --name sipp_"${suffix}" --mount type=bind,source=/tmp/scenarios,target=/tmp --rm --network=host ctaloi/sipp -sf /tmp/sipp_bye_"${suffix}".xml -m 1 -i ${SMM2} -p 12"${suffix}" > /dev/null
              </pre>
              <p class="project-details__desc-para">
                Ces containers éphémères et les scripts les déployant nous ont permis, efficacement, rapidement, de tester des cas de figure qui auraient requis une vingtaine d'appels manuels à vérifier. C'est une brique, qui permet de maintenir le dialplan plus avant et de pouvoir développer avec confiance les scénarios futurs.
              </p>
            </div>
            <div class="project-details__tools-used">
              <h3 class="project-details__content-title">Tools Used</h3>
              <div class="skills">
                <div class="skills__skill">Asterisk</div>
                <div class="skills__skill">SIPp</div>
                <div class="skills__skill">Docker</div>
                <div class="skills__skill">Bash</div>
                <div class="skills__skill">Linux utils</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <footer class="main-footer">
      <div class="main-container">
        <div class="main-footer__upper">
          <div class="main-footer__row main-footer__row-1">
            <h2 class="heading heading-sm main-footer__heading-sm">
              <span>Social</span>
            </h2>
            <div class="main-footer__social-cont">
              <a target="_blank" rel="noreferrer" href="https://www.linkedin.com/in/benoit-schuler/">
                <img
                  class="main-footer__icon"
                  src="./assets/png/linkedin-ico.png"
                  alt="icon"
                />
              </a>
              <a target="_blank" rel="noreferrer" href="https://gitlab.com/bschuler">
                <img
                  class="main-footer__icon"
                  src="./assets/png/gitlab-ico.png"
                  alt="icon"
                />
              </a>
              <a target="_blank" rel="noreferrer" href="https://github.com/Dracosinus">
                <img
                  class="main-footer__icon"
                  src="./assets/png/github-ico.png"
                  alt="icon"
                />
              </a>
            </div>
          </div>
          <div class="main-footer__row main-footer__row-2">
            <h4 class="heading heading-sm text-lt">Benoit SCHULER</h4>            
          </div>
        </div>

        <!-- If you give me some credit or shoutout here by linking to my website, then it will be a big thing for me and will help me a lot :) -->
        <div class="main-footer__lower">
          &copy; Copyright 2021. Template by
          <a rel="noreferrer" target="_blank" href="https://rammaheshwari.com"
            >Ram Maheshwari</a
          >
        </div>
      </div>
    </footer>
    <script src="./index.js"></script>
  </body>
</html>
